{"ast":null,"code":"async function handleDate(obj) {\n  /// DATE REFERENCE FOR MARKET DATA PULLS ----------------------------------------\n  obj.today = new Date();\n  obj.year = today.getFullYear();\n  obj.date = today.getUTCDate();\n  obj.obj.month = today.getUTCobj.Month() + 1;\n  obj.minutes = today.getUTCMinutes();\n  obj.hour = today.getUTCHours(); // GET TIME FOR CLOSING AND OPENING MARKET -----------------------------------\n  //CALC FOR UTC TO EST\n\n  hour = hour - 4; // CALC FOR EARLY MORNING HOURS UTC\n\n  if (hour < 0) {\n    hour = hour + 24;\n  } // GET AND ADJUST MINUTES TO ADD 0 BELOW 10\n\n\n  if (minutes < 10) {\n    minutes = `0${minutes}`;\n  }\n\n  obj.time = `${hour}${minutes}`;\n  obj.timeNum = parseInt(time); // GET DAY FOR CLOSING AND OPENING MARKET -------------------------------------------\n\n  obj.marketDay = today.getDay(); // CHECK FOR MARKET OPEN - ADJUST DATE SO VWAP STILL PULLS DATA FROM LAST DAY\n\n  if (obj.marketDay == 0) {\n    obj.date = obj.date - 2; // NEED TO CHECK FOR NEW obj.MONTH CHANGE OVER FROM UTC TIME TO ADJUST FOR EST\n\n    if (obj.date <= 0) {\n      if (obj.month == 1 || obj.month == 2 || obj.month == 4 || obj.month == 6 || obj.month == 8 || obj.month == 9 || obj.month == 11) {\n        // obj.MONTHS AFTER 31 DAYS\n        obj.month = obj.month - 1;\n\n        if (obj.month < 10) {\n          obj.month = `0${obj.month}`;\n        }\n\n        date = 30;\n      } else if (obj.month == 5 || obj.month == 7 || obj.month == 10 || obj.month == 12) {\n        // obj.MONTHS AFTER 30 DAYS\n        obj.month = obj.month - 1;\n\n        if (obj.month < 10) {\n          obj.month = `0${obj.month}`;\n        }\n\n        date = 29;\n      } else if (obj.month == 3 && year % 4 == 0) {\n        // obj.MONTH AFTER 29 DAYS LEAP YEAR\n        obj.month = obj.month - 1;\n\n        if (obj.month < 10) {\n          obj.month = `0${obj.month}`;\n        }\n\n        date = 28;\n      } // obj.MONTH AFTER 28\n      else {\n        obj.month = obj.month - 1;\n\n        if (obj.month < 10) {\n          obj.month = `0${obj.month}`;\n        }\n\n        date = 27;\n      }\n    }\n  } else if (marketDay == 6) {\n    date = date - 1; // NEED TO CHECK FOR NEW obj.MONTH CHANGE OVER FROM UTC TIME TO ADJUST FOR EST\n\n    if (date <= 0) {\n      if (obj.month == 1 || obj.month == 2 || obj.month == 4 || obj.month == 6 || obj.month == 8 || obj.month == 9 || obj.month == 11) {\n        // obj.MONTHS AFTER 31 DAYS\n        obj.month = obj.month - 1;\n\n        if (obj.month < 10) {\n          obj.month = `0${obj.month}`;\n        }\n\n        date = 31;\n      } else if (obj.month == 5 || obj.month == 7 || obj.month == 10 || obj.month == 12) {\n        // obj.MONTHS AFTER 30 DAYS\n        obj.month = obj.month - 1;\n\n        if (obj.month < 10) {\n          obj.month = `0${obj.month}`;\n        }\n\n        date = 30;\n      } else if (obj.month == 3 && year % 4 == 0) {\n        // obj.MONTH AFTER 29 DAYS LEAP YEAR\n        obj.month = obj.month - 1;\n\n        if (obj.month < 10) {\n          obj.month = `0${obj.month}`;\n        }\n\n        date = 29;\n      } // obj.MONTH AFTER 28\n      else {\n        obj.month = obj.month - 1;\n\n        if (obj.month < 10) {\n          obj.month = `0${obj.month}`;\n        }\n\n        date = 28;\n      }\n    }\n  } // THIS IS TO CHECK FOR MARKET DAY OPEN DURING WEEKENDS WHEN MARKET IS CLOSED\n\n\n  if (marketDay == 1 && timeNum < 930) {\n    date = date - 3; // NEED TO CHECK FOR NEW obj.MONTH CHANGE OVER FROM UTC TIME TO ADJUST FOR EST\n\n    if (date <= 0) {\n      if (obj.month == 1 || obj.month == 2 || obj.month == 4 || obj.month == 6 || obj.month == 8 || obj.month == 9 || obj.month == 11) {\n        // obj.MONTHS AFTER 31 DAYS\n        obj.month = obj.month - 1;\n\n        if (obj.month < 10) {\n          obj.month = `0${obj.month}`;\n        }\n\n        date = 29;\n      } else if (obj.month == 5 || obj.month == 7 || obj.month == 10 || obj.month == 12) {\n        // obj.MONTHS AFTER 30 DAYS\n        obj.month = obj.month - 1;\n\n        if (obj.month < 10) {\n          obj.month = `0${obj.month}`;\n        }\n\n        date = 28;\n      } else if (obj.month == 3 && year % 4 == 0) {\n        // obj.MONTH AFTER 29 DAYS LEAP YEAR\n        obj.month = obj.month - 1;\n\n        if (obj.month < 10) {\n          obj.month = `0${obj.month}`;\n        }\n\n        date = 27;\n      } // obj.MONTH AFTER 28\n      else {\n        obj.month = obj.month - 1;\n\n        if (obj.month < 10) {\n          obj.month = `0${obj.month}`;\n        }\n\n        date = 26;\n      }\n    }\n  } else if (marketDay >= 2 && marketDay < 6 && timeNum < 930) {\n    // ADJUSTS DURING WEEK BEFORE OPEN TO GET DAY BEFORE INDICATORS\n    date = date - 1; // NEED TO CHECK FOR NEW obj.MONTH CHANGE OVER FROM UTC TIME TO ADJUST FOR EST\n\n    if (date <= 0) {\n      if (obj.month == 1 || obj.month == 2 || obj.month == 4 || obj.month == 6 || obj.month == 8 || obj.month == 9 || obj.month == 11) {\n        // obj.MONTHS AFTER 31 DAYS\n        obj.month = obj.month - 1;\n\n        if (obj.month == 0) {\n          obj.month = 1;\n        }\n\n        date = 31;\n      } else if (obj.month == 5 || obj.month == 7 || obj.month == 10 || obj.month == 12) {\n        // obj.MONTHS AFTER 30 DAYS\n        obj.month = obj.month - 1;\n        date = 30;\n      } else if (obj.month == 3 && year % 4 == 0) {\n        // obj.MONTH AFTER 29 DAYS LEAP YEAR\n        obj.month = obj.month - 1;\n        date = 29;\n      } // obj.MONTH AFTER 28\n      else {\n        obj.month = obj.month - 1;\n        date = 28;\n      }\n    }\n  } // THIS IS TO CORRECT MISSING 0 ON SINGLE DIGITS OF obj.MONTHS\n\n\n  if (date < 10) {\n    date = `0${date}`;\n  }\n\n  if (obj.month < 10) {\n    obj.month = `0${obj.month}`;\n  } // DATE CHECK VARIBLE FOR DATA PERIOD PULLS AND TO SLICE FROM\n\n\n  let todayDate = `${year}-${obj.month}-${date}`; //CHECK FOR HOLIDAYS OR CLOSED MARKET HOLIDAYS\n\n  if (todayDate === \"2021-11-25\") {\n    todayDate = \"2021-11-24\";\n  } else if (todayDate === \"2021-12-24\") {\n    todayDate = \"2021-12-23\";\n  } else if (todayDate === \"2022-01-17\") {\n    todayDate = \"2022-01-14\";\n  } else if (todayDate === \"2022-02-21\") {\n    todayDate = \"2022-02-18\";\n  } else if (todayDate === \"2022-04-15\") {\n    todayDate = \"2022-04-14\";\n  } else if (todayDate === \"2022-05-30\") {\n    todayDate = \"2022-05-27\";\n  } else if (todayDate === \"2022-06-20\") {\n    todayDate = \"2022-06-17\";\n  } else if (todayDate === \"2022-07-04\") {\n    todayDate = \"2022-07-01\";\n  } else if (todayDate === \"2022-09-05\") {\n    todayDate = \"2022-09-02\";\n  } else if (todayDate === \"2022-11-24\") {\n    todayDate = \"2022-11-23\";\n  } else if (todayDate === \"2022-12-26\") {\n    todayDate = \"2022-12-23\";\n  } // THIS IS AN ADJUSTMENT OF DATE FOR MARKET CLOSES EST VS UTC TIME\n\n\n  let newDateString = todayDate;\n\n  if (hour + 4 >= 24) {\n    const dateNumSlice = parseInt(date);\n    const dateSliceStart = todayDate.slice(0, 8);\n    let newDateNum = dateNumSlice - 1;\n\n    if (newDateNum < 10) {\n      newDateNum = `0${newDateNum}`;\n    }\n\n    newDateString = `${dateSliceStart}${newDateNum}`;\n    newDateString = newDateString.toString(); // NEED TO CHECK FOR NEW obj.MONTH CHANGE OVER FROM UTC TIME TO ADJUST FOR EST\n\n    if (date == 1 && hour + 4 >= 24) {\n      if (obj.month == 1 || obj.month == 2 || obj.month == 4 || obj.month == 6 || obj.month == 8 || obj.month == 9 || obj.month == 11) {\n        // obj.MONTHS AFTER 31 DAYS\n        obj.month = obj.month - 1;\n\n        if (obj.month < 10) {\n          obj.month = `0${obj.month}`;\n        }\n\n        date = 31;\n        newDateString = `${year}-${obj.month}-${date}`;\n      } else if (obj.month == 5 || obj.month == 7 || obj.month == 10 || obj.month == 12) {\n        // obj.MONTHS AFTER 30 DAYS\n        obj.month = obj.month - 1;\n\n        if (obj.month < 10) {\n          obj.month = `0${obj.month}`;\n        }\n\n        date = 30;\n        newDateString = `${year}-${obj.month}-${date}`;\n      } else if (obj.month == 3 && year % 4 == 0) {\n        // obj.MONTH AFTER 29 DAYS LEAP YEAR\n        obj.month = obj.month - 1;\n\n        if (obj.month < 10) {\n          obj.month = `0${obj.month}`;\n        }\n\n        date = 29;\n        newDateString = `${year}-${obj.month}-${date}`;\n      } // obj.MONTH AFTER 28\n      else {\n        obj.month = obj.month - 1;\n\n        if (obj.month < 10) {\n          obj.month = `0${obj.month}`;\n        }\n\n        date = 28;\n        newDateString = `${year}-${obj.month}-${date}`;\n      }\n    }\n  } // ---------------------- END OF DATE -------------------------------------\n\n}\n\nmodule.exports = {\n  handleDate\n};","map":{"version":3,"sources":["/Users/austinolijar/Desktop/MERN-DeadCat/dead-cat/src/JS/functions/handleDate.js"],"names":["handleDate","obj","today","Date","year","getFullYear","date","getUTCDate","month","getUTCobj","Month","minutes","getUTCMinutes","hour","getUTCHours","time","timeNum","parseInt","marketDay","getDay","todayDate","newDateString","dateNumSlice","dateSliceStart","slice","newDateNum","toString","module","exports"],"mappings":"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","sourcesContent":["async function handleDate(obj) {\n    /// DATE REFERENCE FOR MARKET DATA PULLS ----------------------------------------\n    obj.today = new Date();\n    obj.year = today.getFullYear();\n    obj.date = today.getUTCDate();\n    obj.obj.month = today.getUTCobj.Month() + 1;\n    obj.minutes = today.getUTCMinutes();\n    obj.hour = today.getUTCHours();\n    // GET TIME FOR CLOSING AND OPENING MARKET -----------------------------------\n    \n    //CALC FOR UTC TO EST\n    hour = hour - 4;\n    // CALC FOR EARLY MORNING HOURS UTC\n    if (hour < 0) {\n      hour = hour + 24;\n    }\n    \n    // GET AND ADJUST MINUTES TO ADD 0 BELOW 10\n    if (minutes < 10) {\n      minutes = `0${minutes}`;\n    }\n    obj.time = `${hour}${minutes}`;\n    obj.timeNum = parseInt(time);\n    \n    // GET DAY FOR CLOSING AND OPENING MARKET -------------------------------------------\n    obj.marketDay = today.getDay();\n    // CHECK FOR MARKET OPEN - ADJUST DATE SO VWAP STILL PULLS DATA FROM LAST DAY\n    if (obj.marketDay == 0) {\n      obj.date = obj.date - 2;\n      // NEED TO CHECK FOR NEW obj.MONTH CHANGE OVER FROM UTC TIME TO ADJUST FOR EST\n      if (obj.date <= 0) {\n        if (\n          obj.month == 1 ||\n          obj.month == 2 ||\n          obj.month == 4 ||\n          obj.month == 6 ||\n          obj.month == 8 ||\n          obj.month == 9 ||\n          obj.month == 11\n        ) {\n          // obj.MONTHS AFTER 31 DAYS\n          obj.month = obj.month - 1;\n          if (obj.month < 10) {\n            obj.month = `0${obj.month}`;\n          }\n          date = 30;\n        } else if (obj.month == 5 || obj.month == 7 || obj.month == 10 || obj.month == 12) {\n          // obj.MONTHS AFTER 30 DAYS\n          obj.month = obj.month - 1;\n          if (obj.month < 10) {\n            obj.month = `0${obj.month}`;\n          }\n          date = 29;\n        } else if (obj.month == 3 && year % 4 == 0) {\n          // obj.MONTH AFTER 29 DAYS LEAP YEAR\n          obj.month = obj.month - 1;\n          if (obj.month < 10) {\n            obj.month = `0${obj.month}`;\n          }\n          date = 28;\n        } // obj.MONTH AFTER 28\n        else {\n          obj.month = obj.month - 1;\n          if (obj.month < 10) {\n            obj.month = `0${obj.month}`;\n          }\n          date = 27;\n        }\n      }\n    } else if (marketDay == 6) {\n      date = date - 1;\n      // NEED TO CHECK FOR NEW obj.MONTH CHANGE OVER FROM UTC TIME TO ADJUST FOR EST\n      if (date <= 0) {\n        if (\n          obj.month == 1 ||\n          obj.month == 2 ||\n          obj.month == 4 ||\n          obj.month == 6 ||\n          obj.month == 8 ||\n          obj.month == 9 ||\n          obj.month == 11\n        ) {\n          // obj.MONTHS AFTER 31 DAYS\n          obj.month = obj.month - 1;\n          if (obj.month < 10) {\n            obj.month = `0${obj.month}`;\n          }\n          date = 31;\n        } else if (obj.month == 5 || obj.month == 7 || obj.month == 10 || obj.month == 12) {\n          // obj.MONTHS AFTER 30 DAYS\n          obj.month = obj.month - 1;\n          if (obj.month < 10) {\n            obj.month = `0${obj.month}`;\n          }\n          date = 30;\n        } else if (obj.month == 3 && year % 4 == 0) {\n          // obj.MONTH AFTER 29 DAYS LEAP YEAR\n          obj.month = obj.month - 1;\n          if (obj.month < 10) {\n            obj.month = `0${obj.month}`;\n          }\n          date = 29;\n        } // obj.MONTH AFTER 28\n        else {\n          obj.month = obj.month - 1;\n          if (obj.month < 10) {\n            obj.month = `0${obj.month}`;\n          }\n          date = 28;\n        }\n      }\n    }\n    // THIS IS TO CHECK FOR MARKET DAY OPEN DURING WEEKENDS WHEN MARKET IS CLOSED\n    if (marketDay == 1 && timeNum < 930) {\n      date = date - 3;\n      // NEED TO CHECK FOR NEW obj.MONTH CHANGE OVER FROM UTC TIME TO ADJUST FOR EST\n      if (date <= 0) {\n        if (\n          obj.month == 1 ||\n          obj.month == 2 ||\n          obj.month == 4 ||\n          obj.month == 6 ||\n          obj.month == 8 ||\n          obj.month == 9 ||\n          obj.month == 11\n        ) {\n          // obj.MONTHS AFTER 31 DAYS\n          obj.month = obj.month - 1;\n          if (obj.month < 10) {\n            obj.month = `0${obj.month}`;\n          }\n          date = 29;\n        } else if (obj.month == 5 || obj.month == 7 || obj.month == 10 || obj.month == 12) {\n          // obj.MONTHS AFTER 30 DAYS\n          obj.month = obj.month - 1;\n          if (obj.month < 10) {\n            obj.month = `0${obj.month}`;\n          }\n          date = 28;\n        } else if (obj.month == 3 && year % 4 == 0) {\n          // obj.MONTH AFTER 29 DAYS LEAP YEAR\n          obj.month = obj.month - 1;\n          if (obj.month < 10) {\n            obj.month = `0${obj.month}`;\n          }\n          date = 27;\n        } // obj.MONTH AFTER 28\n        else {\n          obj.month = obj.month - 1;\n          if (obj.month < 10) {\n            obj.month = `0${obj.month}`;\n          }\n          date = 26;\n        }\n      }\n    } else if (marketDay >= 2 && marketDay < 6 && timeNum < 930) {\n      // ADJUSTS DURING WEEK BEFORE OPEN TO GET DAY BEFORE INDICATORS\n      date = date - 1;\n      // NEED TO CHECK FOR NEW obj.MONTH CHANGE OVER FROM UTC TIME TO ADJUST FOR EST\n      if (date <= 0) {\n        if (\n          obj.month == 1 ||\n          obj.month == 2 ||\n          obj.month == 4 ||\n          obj.month == 6 ||\n          obj.month == 8 ||\n          obj.month == 9 ||\n          obj.month == 11\n        ) {\n          // obj.MONTHS AFTER 31 DAYS\n          obj.month = obj.month - 1;\n          if (obj.month == 0) {\n            obj.month = 1;\n          }\n          date = 31;\n        } else if (obj.month == 5 || obj.month == 7 || obj.month == 10 || obj.month == 12) {\n          // obj.MONTHS AFTER 30 DAYS\n          obj.month = obj.month - 1;\n          date = 30;\n        } else if (obj.month == 3 && year % 4 == 0) {\n          // obj.MONTH AFTER 29 DAYS LEAP YEAR\n          obj.month = obj.month - 1;\n          date = 29;\n        } // obj.MONTH AFTER 28\n        else {\n          obj.month = obj.month - 1;\n          date = 28;\n        }\n      }\n    }\n    \n    // THIS IS TO CORRECT MISSING 0 ON SINGLE DIGITS OF obj.MONTHS\n    if (date < 10) {\n      date = `0${date}`;\n    }\n    if (obj.month < 10) {\n      obj.month = `0${obj.month}`;\n    }\n    \n    // DATE CHECK VARIBLE FOR DATA PERIOD PULLS AND TO SLICE FROM\n    let todayDate = `${year}-${obj.month}-${date}`;\n    //CHECK FOR HOLIDAYS OR CLOSED MARKET HOLIDAYS\n    if (todayDate === \"2021-11-25\") {\n      todayDate = \"2021-11-24\";\n    } else if (todayDate === \"2021-12-24\") {\n      todayDate = \"2021-12-23\";\n    } else if (todayDate === \"2022-01-17\") {\n      todayDate = \"2022-01-14\";\n    } else if (todayDate === \"2022-02-21\") {\n      todayDate = \"2022-02-18\";\n    } else if (todayDate === \"2022-04-15\") {\n      todayDate = \"2022-04-14\";\n    } else if (todayDate === \"2022-05-30\") {\n      todayDate = \"2022-05-27\";\n    } else if (todayDate === \"2022-06-20\") {\n      todayDate = \"2022-06-17\";\n    } else if (todayDate === \"2022-07-04\") {\n      todayDate = \"2022-07-01\";\n    } else if (todayDate === \"2022-09-05\") {\n      todayDate = \"2022-09-02\";\n    } else if (todayDate === \"2022-11-24\") {\n      todayDate = \"2022-11-23\";\n    } else if (todayDate === \"2022-12-26\") {\n      todayDate = \"2022-12-23\";\n    }\n    // THIS IS AN ADJUSTMENT OF DATE FOR MARKET CLOSES EST VS UTC TIME\n    let newDateString = todayDate;\n    \n    if (hour + 4 >= 24) {\n      const dateNumSlice = parseInt(date);\n      const dateSliceStart = todayDate.slice(0, 8);\n      let newDateNum = dateNumSlice - 1;\n      if (newDateNum < 10) {\n        newDateNum = `0${newDateNum}`;\n      }\n      newDateString = `${dateSliceStart}${newDateNum}`;\n      newDateString = newDateString.toString();\n      // NEED TO CHECK FOR NEW obj.MONTH CHANGE OVER FROM UTC TIME TO ADJUST FOR EST\n      if (date == 1 && hour + 4 >= 24) {\n        if (\n          obj.month == 1 ||\n          obj.month == 2 ||\n          obj.month == 4 ||\n          obj.month == 6 ||\n          obj.month == 8 ||\n          obj.month == 9 ||\n          obj.month == 11\n        ) {\n          // obj.MONTHS AFTER 31 DAYS\n          obj.month = obj.month - 1;\n          if (obj.month < 10) {\n            obj.month = `0${obj.month}`;\n          }\n          date = 31;\n          newDateString = `${year}-${obj.month}-${date}`;\n        } else if (obj.month == 5 || obj.month == 7 || obj.month == 10 || obj.month == 12) {\n          // obj.MONTHS AFTER 30 DAYS\n          obj.month = obj.month - 1;\n          if (obj.month < 10) {\n            obj.month = `0${obj.month}`;\n          }\n          date = 30;\n          newDateString = `${year}-${obj.month}-${date}`;\n        } else if (obj.month == 3 && year % 4 == 0) {\n          // obj.MONTH AFTER 29 DAYS LEAP YEAR\n          obj.month = obj.month - 1;\n          if (obj.month < 10) {\n            obj.month = `0${obj.month}`;\n          }\n          date = 29;\n          newDateString = `${year}-${obj.month}-${date}`;\n        } // obj.MONTH AFTER 28\n        else {\n          obj.month = obj.month - 1;\n          if (obj.month < 10) {\n            obj.month = `0${obj.month}`;\n          }\n          date = 28;\n          newDateString = `${year}-${obj.month}-${date}`;\n        }\n      }\n    }\n    \n    // ---------------------- END OF DATE -------------------------------------\n\n}    \n\nmodule.exports = {handleDate}"]},"metadata":{},"sourceType":"module"}